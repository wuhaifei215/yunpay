<include file="Public/header"/>
<div class="row">
	<div class="col-sm-12">
		<form class="layui-form" action="" id="profile">
			<input type="hidden" name="userid" value="<{$u.id}>">
			<div class="layui-form-item">
				<label class="layui-form-label">用户名：</label>
				<div class="layui-input-inline">
					<input type="text" name="u[username]" lay-verify="required" autocomplete="off"
						   value="<{$u.username|htmlentities}>"
						   placeholder="用户名"
						   class="layui-input"
					<if condition="$u.id gt 0">disabled="disabled"</if>
					>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">所属国家：</label>
				<div class="layui-input-inline">
					<select name="u[country_id]" lay-verify="" lay-search="">
						<option value=""></option>
						<foreach name="country" item="v" key="k">
							<option <if condition="$u['country_id'] eq $v['id']">selected</if> value="<{$v['id']}>"><{$v['name']}>(<{$v['code']}>)</option>
						</foreach>
					</select>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">所属代理：</label>
				<div class="layui-input-inline">
					<select name="u[parentid]" lay-verify="" lay-search="">
						<option value=""></option>
						<foreach name="agent" item="v" key="k">
							<option <if condition="$u['parentid'] eq $v['id']">selected</if>
							value="<{$v['id']}>"><{$v['username']}></option>
						</foreach>

					</select>
				</div>
			</div>

			<!--<div class="layui-form-item">-->
			<!--	<label class="layui-form-label">姓名：</label>-->
			<!--	<div class="layui-input-inline">-->
			<!--		<input type="text" name="u[realname]" lay-verify="" autocomplete="off"-->
			<!--			   value="<{$u.realname|htmlentities}>"-->
			<!--			   placeholder="姓名"-->
			<!--			   class="layui-input">-->
			<!--	</div>-->
			<!--</div>-->
			<!--<div class="layui-form-item">-->
			<!--	<label class="layui-form-label">性别：</label>-->
			<!--	<div class="layui-input-inline">-->
			<!--		<select name="u[sex]" lay-search="">-->
			<!--			<option value=""></option>-->
			<!--			<option <if condition="$u['sex'] eq 0">selected</if> value="0">女</option>-->
			<!--			<option <if condition="$u['sex'] eq 1">selected</if> value="1">男</option>-->
			<!--		</select>-->
			<!--	</div>-->
			<!--</div>-->

			<!--<div class="layui-form-item">-->
			<!--	<label class="layui-form-label">身份证号：</label>-->
			<!--	<div class="layui-input-inline">-->
			<!--		<input type="text" name="u[sfznumber]" lay-verify="" autocomplete="off" value="<{$u.sfznumber|htmlentities}>" placeholder="身份证号" class="layui-input">-->
			<!--	</div>-->
			<!--</div>-->
			<!--<div class="layui-form-item">-->
			<!--	<label class="layui-form-label">出生日期：</label>-->
			<!--	<div class="layui-inline">-->
			<!--		<input class="layui-input" name="u[birthday]" placeholder="出生日期" id="birthday" value="<{$u[birthday]|date="Y-m-d",###}>">-->
			<!--	</div>-->
			<!--</div>-->

			<!--<div class="layui-form-item">-->
			<!--	<label class="layui-form-label">手机号码：</label>-->
			<!--	<div class="layui-input-inline">-->
			<!--		<input type="text" name="u[mobile]" lay-verify="" autocomplete="off" value="<{$u.mobile|htmlentities}>" placeholder="手机号码" class="layui-input">-->
			<!--	</div>-->
			<!--</div>-->

			<!--<div class="layui-form-item">-->
			<!--	<label class="layui-form-label">联系QQ：</label>-->
			<!--	<div class="layui-input-inline">-->
			<!--		<input type="text" name="u[qq]" autocomplete="off" value="<{$u.qq|htmlentities}>" placeholder="联系QQ"-->
			<!--			   class="layui-input">-->
			<!--	</div>-->
			<!--</div>-->

			<div class="layui-form-item">
				<label class="layui-form-label">Email：</label>
				<div class="layui-input-inline">
					<input type="text" name="u[email]" lay-verify="" autocomplete="off" value="<{$u.email|htmlentities}>" placeholder="Email" class="layui-input">
				</div>
			</div>

			<div class="layui-form-item">
				<label class="layui-form-label">用户级别：</label>
				<div class="layui-input-inline">
					<select name="u[groupid]" lay-verify="" lay-search="">
						<option value=""></option>
						<foreach name="groupId" item="v" key="k">
							<option <if condition="$u['groupid'] eq $k">selected</if>
							value="<{$k}>"><{$v}></option>
						</foreach>

					</select>
				</div>
			</div>

			<!--<div class="layui-form-item">-->
			<!--	<label class="layui-form-label">联系地址：</label>-->
			<!--	<div class="layui-inline">-->
			<!--		<div class="layui-input-inline">-->
			<!--			<input type="text" name="u[address]" lay-verify="" autocomplete="off" value="<{$u.address|htmlentities}>" placeholder="联系地址" class="layui-input">-->
			<!--		</div>-->
			<!--	</div>-->
			<!--</div>-->

			<div class="layui-form-item">
				<label class="layui-form-label">登录密码：</label>
				<div class="layui-input-inline">
					<input type="password" name="u[password]" autocomplete="off" value="" placeholder="登录密码" class="layui-input">
				</div>
			</div>

			<div class="layui-form-item layui-form-text">
				<label class="layui-form-label">登录IP白名单：</label>
				<div class="layui-input-block">
					<textarea name="u[login_ip]" placeholder="如：127.0.0.1，多个IP请换行，一行一个IP" class="layui-textarea"><{$u[login_ip]}></textarea>
				</div>
			</div>

			<!--<div class="layui-form-item layui-form-text">-->
			<!--	<label class="layui-form-label">代付通道编码：</label>-->
			<!--	<div class="layui-input-block">-->
			<!--		<textarea name="u[pfa_channel]" placeholder="多个通道请用英文逗号（,）隔开" class="layui-textarea"><{$u[pfa_channel]}></textarea>-->
			<!--	</div>-->
			<!--</div>-->

			<div class="layui-form-item">
				<label class="layui-form-label">代付API接口状态：</label>
				<div class="layui-input-block">
					<input type="radio" name="u[df_api]" lay-filter="df_api" value="1" title="开启" <if
						condition="$u['df_api'] eq 1">checked
				</if>>
					<input type="radio" name="u[df_api]" lay-filter="df_api" value="0" title="关闭" <if
						condition="$u['df_api'] eq 0">checked
				</if>>
				</div>
			</div>
            <div id="df_auto" <if condition="$u['df_api'] eq 0">style="display: none;" </if>>
			<!--<div class="layui-form-item" id="df_auto_check" <if  condition="$u['df_api'] eq 0">style="display: none;"</if>>-->
			<!--<label class="layui-form-label">代付API自动审核：</label>-->
			<!--<div class="layui-input-block">-->
			<!--	<input type="radio" name="u[df_auto_check]" lay-filter="df_auto_check" value="1" title="开启" <if-->
			<!--		condition="$u['df_auto_check'] eq 1">checked-->
			<!--</if>>-->
			<!--	<input type="radio" name="u[df_auto_check]" lay-filter="df_auto_check" value="0" title="关闭" <if-->
			<!--		condition="$u['df_auto_check'] eq 0">checked-->
			<!--</if>>-->
			<!--</div>-->
            	<!--</div>-->
            <!--	<div class="layui-form-item" id="df_domain" <if  condition="$u['df_api'] eq 0">style="display: none;"</if>>-->
            <!--	<label class="layui-form-label">代付域名报备：</label>-->
            <!--	<div class="layui-input-block">-->
            <!--		<textarea name="u[df_domain]" placeholder="如：www.baidu.com，多个域名请换行，一行一个域名" class="layui-textarea"><{$u[df_domain]}></textarea>-->
            <!--	</div>-->
            <!--	<label class="layui-form-label"></label><div class="layui-form-mid layui-word-aux">注意：无需填写http://或https://，也不需要填写具体路径，结尾不加 /，一行一个域名。下级商户只能从这些域名发起代付请求！</div>-->
            <!--</div>-->
                <div class="layui-form-item" id="df_ip">
                <label class="layui-form-label">代付IP报备：</label>
                <div class="layui-input-block">
                	<textarea name="u[df_ip]" placeholder="如：127.0.0.1，多个IP请换行，一行一个IP" class="layui-textarea"><{$u[df_ip]}></textarea>
                </div>
                <label class="layui-form-label"></label><div class="layui-form-mid layui-word-aux">注意：请填写发起代付请求的服务器公网IP一行一个IP地址。</div>
                </div>
    
                <div class="layui-form-item">
    				<label class="layui-form-label">代付审核金额：</label>
    				<div class="layui-input-inline">
    					<input type="auto_tkmoney" name="u[auto_tkmoney]" value="<{$u.auto_tkmoney}>" autocomplete="off" value="" placeholder="代付审核金额" class="layui-input">
    				</div>
    			</div>
                <div class="layui-form-item" id="operators">
                    <label class="layui-form-label">代付审核人员：</label>
                    <div class="layui-input-block">
                    	<textarea name="u[operators]" placeholder="请填写 Telegram 审核人员的用户名，一行一个用户名" class="layui-textarea"><{$u[operators]}></textarea>
                    </div>
                    <label class="layui-form-label"></label><div class="layui-form-mid layui-word-aux">注意：请填写 Telegram 审核人员的用户名，一行一个用户名。</div>
                </div>
            </div>
                <if condition="$verifyGoogle and $verifysms">
    				<div class="layui-form-item" id="df_auto_check">
    					<label class="layui-form-label">验证方式：</label>
    					<div class="layui-input-block">
    						<input type="radio" name="auth_type" lay-filter="auth_type" value="1" title="谷歌安全码" checked>
    						<input type="radio" name="auth_type" lay-filter="auth_type" value="0" title="短信验证码">
    					</div>
    				</div>
				<else />
					<input type="hidden" name="auth_type" value="<{$auth_type}>">
				</if>
				<eq name="verifyGoogle" value="1">
				<div class="layui-form-item" id="auth_google">
					<label class="layui-form-label">谷歌安全码：</label>
					<div class="layui-input-inline">
						<input type="text" name="google_code" autocomplete="off"
							   placeholder="请输入谷歌安全码" class="layui-input" value="">
					</div>
				</div>
				</eq>
				<eq name="verifysms" value="1">
					<div class="layui-form-item" id="auth_sms" <if condition="$verifyGoogle and $verifysms">style="display: none"</if>>
					<label class="layui-form-label">手机验证码：</label>
					<div class="layui-input-inline">
						<input type="text" name="code"  autocomplete="off"
							   placeholder="请输入短信验证码" class="layui-input" value="">
					</div>
					<div class="layui-input-inline">
						<a href="javascript:;" id="sendBtn" data-mobile="<{$mobile}>" class="layui-btn">发送验证码</a>
					</div>
				</div>
				</eq>
				
<div class="layui-form-item">
	<div class="layui-input-block">
		<button class="layui-btn" lay-submit="submit" lay-filter="save">提交保存</button>
	</div>
</div>
</form>
</div>
</div>
<include file="Public/footer"/>
<script>
    layui.use(['layer', 'form','laydate'], function(){
        var form = layui.form
            ,laydate = layui.laydate
            ,layer = layui.layer;

        //常规用法
        laydate.render({
            elem: '#birthday'
        });
        form.on('radio(df_api)',function(data){
            if(data.value == 1) {
                $('#df_auto_check').show();
                $('#df_domain').show();
                $('#df_auto').show();
            } else {
                $('#df_auto_check').hide();
                $('#df_domain').hide();
                $('#df_auto').hide();
            }
        });
        //监听提交
        form.on('submit(save)', function(data){
            $.ajax({
                url:"<{:U('User/saveUser')}>",
                type:"post",
                data:$('#profile').serialize(),
                success:function(res){
                    if(res.status){
                        layer.alert("编辑成功", {icon: 6},function () {
                            parent.location.reload();
                            var index = parent.layer.getFrameIndex(window.name);
                            parent.layer.close(index);
                        });
                    }else{
                        layer.alert("操作失败:" + res.msg, {icon: 5},function (index) {
                            layer.close(index)
                        });
                    }
                }
            });
            return false;
        });
    });
</script>
<!--统计代码，可删除-->
</body>
</html>
